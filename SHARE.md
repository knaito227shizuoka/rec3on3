# 共有機能 開発戦略

## 概要

「マッチアップを追加」ボタンの左に「共有」ボタンを設置し、モーダルで2つの共有オプションを提供する。

## UI設計

### ボタン配置
```
[📤 共有] [＋ マッチアップを追加]
```

### 共有モーダル
- タイトル: 「共有」
- オプション1: 「このアプリを教える」→ ベースURLをコピー
- オプション2: 「結果を教える」→ GETパラメータ付きURLをコピー
- URLコピー後にフィードバック表示（「コピーしました！」）

## URL設計

### オプション1: ベースURL
```
https://rec3on3.web.app/
```

### オプション2: 結果付きURL（GETパラメータ）

#### データ圧縮戦略

URLを短くするため、以下の方針で文字数を節約：

1. **パラメータ名を短縮**
   - 1-2文字の短いキーを使用

2. **色のキー短縮**
   - red → r
   - green → g
   - blue → b
   - purple → p
   - black → k
   - yellow → y

3. **先行/後攻、勝敗の短縮**
   - 先行 → f (first)
   - 後攻 → l (last)
   - 勝ち → w (win)
   - 負け → x (lose)

4. **配列ベースのデータ構造**
   - 連想配列ではなく、位置で識別する配列形式
   - 区切り文字: `|` (項目区切り), `,` (配列要素区切り), `:` (フィールド区切り)

#### URL形式案

```
?d=タイトル|P1名|P1キャラ|P1色|P2名|P2キャラ|P2色|P3名|P3キャラ|P3色|マッチアップデータ
```

**マッチアップデータの形式:**
```
m1cell1:m1cell2:m1cell3;m2cell1:m2cell2:m2cell3;...
```

**各セルの形式:**
```
相手色,勝敗,先後,相手キャラ
```
例: `rg,w,f,リュウ` → 赤緑の相手、勝ち、先行、キャラはリュウ

空のセルは `-` で表現

#### URL例

```
?d=第1回大会|太郎|ケン|r,g|次郎|リュウ|b|三郎|春麗|y|rg,w,f,リュウ:b,x,l,ケン:y,w,f,春麗;-:-:-
```

## 実装ステップ

### 1. データ圧縮ロジック実装
- `compressData()`: アプリデータ → 短縮URL文字列
- `decompressData()`: 短縮URL文字列 → アプリデータ

### 2. UI追加
- 共有ボタンを追加
- 共有モーダルを追加
- モーダル内の2つのオプションボタン

### 3. URLパラメータ読み込み
- ページロード時にGETパラメータをチェック
- パラメータがあれば`decompressData()`で復元してVueデータに適用

### 4. クリップボードコピー
- `navigator.clipboard.writeText()`を使用
- コピー成功/失敗のフィードバック表示

## 技術メモ

### エンコーディング
- 日本語テキストは`encodeURIComponent()`でエンコード
- デコードは`decodeURIComponent()`

### 空データの扱い
- 空のプレイヤー名/キャラは省略可能にする（省略時はデフォルト値）
- 空のマッチアップセルは `-` で表現

### URL長制限
- URLの最大長は約2000文字が安全
- それを超える場合は警告を表示するか、代替手段を提案

## テストケース

1. 空データの共有
2. 一部入力済みデータの共有
3. 全て入力済みデータの共有
4. 日本語を含むデータの共有
5. 複数マッチアップの共有
6. URLから復元時のデータ整合性確認
