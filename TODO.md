# rec3on3 開発戦略

## 現状

- 単一ページアプリケーション（public/index.html）
- Vue.js 3 (CDN版) 使用
- データは保存されない（その場限り）
- 3人チーム対戦成績記録機能

## やりたいこと

複数セッションの管理とデータ永続化

### 要件

1. **トップページの新設**
   - 複数の対戦記録セッションをリスト表示
   - 各セッションはタイトルで識別
   - セッションの作成・削除・選択が可能

2. **対戦記録ページの分離**
   - 現在のindex.htmlをmatching.htmlに移動
   - 特定セッションの対戦記録を表示・編集
   - トップページに戻る機能

3. **データ永続化**
   - ブラウザローカルに保存（サーバーレス）
   - 複数セッションのデータを管理

## ストレージ選定

### 比較検討

| 機能 | LocalStorage | IndexedDB | SessionStorage |
|------|-------------|-----------|----------------|
| 容量 | 5-10MB | 制限緩い | 5-10MB |
| API | 同期的・シンプル | 非同期・複雑 | 同期的・シンプル |
| データ形式 | 文字列のみ | 構造化データ | 文字列のみ |
| 永続性 | 永続 | 永続 | タブ閉じると消失 |
| 適用シーン | 小規模データ | 大規模・複雑 | 一時データ |

### 推奨: LocalStorage

**理由:**
- データサイズが小さい（対戦記録はテキストベース）
- シンプルなAPI、実装が容易
- 同期的な読み書きで十分
- Vue.js CDN版との相性が良い

**データ構造案:**
```javascript
// LocalStorageキー: 'rec3on3_sessions'
[
  {
    id: 'unique-id-1',
    title: '2025年1月の対戦記録',
    createdAt: '2025-01-15T10:00:00Z',
    updatedAt: '2025-01-20T15:30:00Z',
    data: {
      pageTitle: '2025年1月の対戦記録',
      players: [...],
      matchups: [...]
    }
  },
  {
    id: 'unique-id-2',
    title: '2025年2月の対戦記録',
    ...
  }
]
```

## 実装ステップ

### フェーズ1: データ永続化層の実装

- [ ] LocalStorageラッパー関数作成
  - `loadSessions()`: 全セッション取得
  - `saveSession(session)`: セッション保存
  - `deleteSession(id)`: セッション削除
  - `getSession(id)`: 特定セッション取得

### フェーズ2: 対戦記録ページの分離

- [ ] 現在の `public/index.html` を `public/matching.html` にリネーム
- [ ] URL/ハッシュパラメータでセッションID受け取り
- [ ] セッションデータの自動保存機能
  - データ変更時にLocalStorageに保存
  - watcherまたは手動トリガー
- [ ] トップページへの戻るボタン追加

### フェーズ3: トップページの作成

- [ ] 新規 `public/index.html` を作成（セッション一覧ページ）
- [ ] セッション一覧表示UI
  - カード形式でセッションを表示
  - タイトル、更新日時、マッチアップ数を表示
- [ ] セッション操作機能
  - 新規セッション作成ボタン
  - セッション削除機能
  - セッション選択でmatching.htmlに遷移

### フェーズ4: ルーティング実装

**シンプルなハッシュルーティング案:**
```
/                    -> トップページ
#/matching/{sessionId} -> 対戦記録ページ
```

または

**ファイルベースルーティング案:**
```
/index.html          -> トップページ
/matching.html?id={sessionId} -> 対戦記録ページ
```

推奨: ファイルベースが静的ホスティングと相性良い

### フェーズ5: UX改善

- [ ] セッション作成時のタイトル入力モーダル
- [ ] 削除時の確認ダイアログ
- [ ] セッションのソート機能（更新日時順）
- [ ] 検索・フィルター機能（オプション）

## 技術的考慮事項

### エラーハンドリング
- LocalStorage容量オーバー時の対応
- JSON parse/stringify エラー処理
- 存在しないセッションIDへのアクセス

### データマイグレーション
- 初回アクセス時のデータ構造初期化
- 将来的な構造変更への対応

### パフォーマンス
- セッション数が増えた場合のリスト表示
- データ保存頻度の調整（debounce検討）

## 将来的な拡張案

### データエクスポート・インポート
- JSON形式でデータダウンロード
- ファイルからデータインポート
- バックアップ機能

### データ同期
- Firebase Realtime DatabaseまたはFirestore連携
- ユーザー認証追加
- 複数デバイス間でのデータ共有

### 統計機能
- 全セッションの勝率統計
- プレイヤー別成績
- グラフ表示

## 開発優先度

1. **高**: フェーズ1-3（基本機能実装）
2. **中**: フェーズ4-5（UX改善）
3. **低**: 将来的な拡張案（必要に応じて）

## 備考

### ファイル構成（実装後）

```
public/
├── index.html      # トップページ（セッション一覧）
├── matching.html   # 対戦記録ページ（現在のindex.html）
└── style.css       # 共通スタイル
```

### 技術仕様

- Vue.js 3 CDN版を継続使用
- ダークテーマUIを維持
- レスポンシブデザイン対応継続
- Firebase Hosting互換性維持
